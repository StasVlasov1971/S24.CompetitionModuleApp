/* jquery.multisortable.js - v0.2*/ !function(a){a.fn.multiselectable=function(b){function c(c){var d=a(this),e=d.parent(),f=d.index(),g=e.find(".multiselectable-previous");g=g.length?g:a(e.find("."+b.selectedClass)[0]).addClass("multiselectable-previous");var h=g.index();if((c.ctrlKey||c.metaKey)&&(d.hasClass(b.selectedClass)?(d.removeClass(b.selectedClass).removeClass("multiselectable-previous"),d.not(".child").length&&d.nextUntil(":not(.child)").removeClass(b.selectedClass)):(e.find(".multiselectable-previous").removeClass("multiselectable-previous"),d.addClass(b.selectedClass).addClass("multiselectable-previous"),d.not(".child").length&&d.nextUntil(":not(.child)").addClass(b.selectedClass))),c.shiftKey){var i=e.find(".multiselectable-shift");i.removeClass(b.selectedClass).removeClass("multiselectable-shift");var j;f>h?j=d.prevUntil(".multiselectable-previous").add(g).add(d):h>f&&(j=d.nextUntil(".multiselectable-previous").add(g).add(d)),j.addClass(b.selectedClass).addClass("multiselectable-shift")}else e.find(".multiselectable-shift").removeClass("multiselectable-shift");c.ctrlKey||c.metaKey||c.shiftKey||(e.find(".multiselectable-previous").removeClass("multiselectable-previous"),d.hasClass(b.selectedClass)||d.not(".child").length&&d.nextUntil(":not(.child)").addClass(b.selectedClass)),b.mousedown(c,d)}function d(c){if(!a(this).is(".ui-draggable-dragging")){var d=a(this),e=d.parent();c.ctrlKey||c.metaKey||c.shiftKey||(e.find(".multiselectable-previous").removeClass("multiselectable-previous"),d.toggleClass(b.selectedClass).addClass("multiselectable-previous"),d.not(".child").length&&d.nextUntil(":not(.child)").addClass(b.selectedClass)),b.click(c,d)}}return b||(b={}),b=a.extend({},a.fn.multiselectable.defaults,b),this.each(function(){var e=a(this);e.data("multiselectable")||e.data("multiselectable",!0).delegate(b.items,"mousedown",c).delegate(b.items,"click",d).disableSelection()})},a.fn.multiselectable.defaults={click:function(a,b){},mousedown:function(a,b){},selectedClass:"selected",items:"li"},a.fn.multisortable=function(b){function c(b,c){if(c.find("."+d.selectedClass).length>0){var e=b.data("i"),f=c.find("."+d.selectedClass).filter(function(){return a(this).data("i")<e}).css({position:"",width:"",left:"",top:"",zIndex:""});b.before(f);var g=c.find("."+d.selectedClass).filter(function(){return a(this).data("i")>e}).css({position:"",width:"",left:"",top:"",zIndex:""});b.after(g),setTimeout(function(){g.add(f)},0)}}b||(b={});var d=a.extend({},a.fn.multisortable.defaults,b);return this.each(function(){var e=a(this);e.multiselectable({selectedClass:d.selectedClass,click:d.click,items:d.items,mousedown:d.mousedown}),b.cancel=d.items+":not(."+d.selectedClass+")",b.placeholder=d.placeholder,b.start=function(b,c){if(c.item.hasClass(d.selectedClass)){var e=c.item.parent();e.find("."+d.selectedClass).each(function(b){a(this).data("i",b)});var f=e.find("."+d.selectedClass).length*c.item.outerHeight();c.placeholder.height(f)}d.start(b,c)},b.stop=function(a,b){c(b.item,b.item.parent()),d.stop(a,b)},b.sort=function(b,c){var e=c.item.parent(),f=c.item.data("i"),g=parseInt(c.item.css("top").replace("px","")),h=parseInt(c.item.css("left").replace("px",""));a.fn.reverse=Array.prototype._reverse||Array.prototype.reverse;var i=0;a("."+d.selectedClass,e).filter(function(){return a(this).data("i")<f}).reverse().each(function(){i+=a(this).outerHeight(),a(this).css({left:h,top:g-i,position:"absolute",zIndex:1e3,width:c.item.width()})}),i=c.item.outerHeight(),a("."+d.selectedClass,e).filter(function(){return a(this).data("i")>f}).each(function(){var b=a(this);b.css({left:h,top:g+i,position:"absolute",zIndex:1e3,width:c.item.width()}),i+=b.outerHeight()}),d.sort(b,c)},b.receive=function(a,b){c(b.item,b.sender),d.receive(a,b)},e.sortable(b).disableSelection()})},a.fn.multisortable.defaults={start:function(a,b){},stop:function(a,b){},sort:function(a,b){},receive:function(a,b){},click:function(a,b){},mousedown:function(a,b){},selectedClass:"selected",placeholder:"placeholder",items:"li"}}(jQuery);